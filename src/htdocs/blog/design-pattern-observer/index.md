---
title: デザインパターンの学習メモ「Strategy パターン」
tags: design_pattern
description: GoFのデザインパターンのうちの一つである「Strategy パターン」についての学習メモ。
datePublished: 2018-09-27
---

GoF のデザインパターンのうちの一つ、Strategy パターンについて PHP のサンプルコードを交えて学習していく。

Strategy パターンは、[Wikipedia では以下のように解説](https://ja.wikipedia.org/wiki/Strategy_%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3)されている。

> Strategy パターンは、コンピュータープログラミングの領域において、アルゴリズムを実行時に選択することができるデザインパターンである。

この一文ではわかりにくいが、このパターンの目的についての解説は比較的わかりやすい。

> Strategy パターンは、アプリケーションで使用されるアルゴリズムを動的に切り替える必要がある際に有用である。Strategy パターンはアルゴリズムのセットを定義する方法を提供し、これらを交換可能にすることを目的としている。Strategy パターンにより、アルゴリズムを使用者から独立したまま様々に変化させることができるようになる。

実際に Strategy パターンがどういうものなのかを、サンプルコードを用いながら考えていく。

## Strategy パターンを使用しない例

ゲームの敵をサンプルとして用いる。

* [sample 1](https://github.com/hbsnow/design-pattern-php-sample/tree/master/htdocs/strategy/sample1)

Monser という具象クラスがあり、それぞれのモンスター

* Goblin (歩ける・攻撃できる)
* Slime (ゆっくり歩ける・攻撃できる)
* Mandragora (攻撃できる)
* Dragon (歩ける・飛べる・攻撃できる)

は Monser クラスを継承している。共通でないモンスターの行動「歩く」と「飛ぶ」についてはインターフェースを作成してそれぞれの継承先のクラスに実装した。

問題はインターフェースが実装をもたないことから、Goblin と Dragon の「歩く」という同じコードの再利用ができず、また変更に対して閉じていないために保守性が損なわれている。

この問題を解決するためには、実装にではなく振る舞いに対してコードを書く必要がある。

## Strategy パターンを使用する例

* [sample 2](https://github.com/hbsnow/design-pattern-php-sample/tree/master/htdocs/strategy/sample2)

上記のサンプルでは

* 歩く
* 飛ぶ

の2つの振る舞いに対してプログラミングしている。

攻撃することはすべてのモンスターに共通しているので、Monster 抽象クラスに攻撃するメソッドを記述しているが、この例であれば攻撃の種類は今後増えていきそうな気がするので、本来ここもインターフェースで切り出すべきかもしれない。
