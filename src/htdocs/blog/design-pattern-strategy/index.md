---
title: デザインパターンの学習メモ「Strategy パターン」
tags: design_pattern
description: GoFのデザインパターンのうちの一つである「Strategy パターン」についての学習メモ。
datePublished: 2018-09-27
---

GoF のデザインパターンのうちの一つ、Strategy パターンについて PHP のサンプルコードを交えて学習していきます。

Strategy パターンは、[Wikipedia では以下のように解説](https://ja.wikipedia.org/wiki/Strategy_%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3)されています。

> Strategy パターンは、コンピュータープログラミングの領域において、アルゴリズムを実行時に選択することができるデザインパターンである。

この一文ではわかりにくいのですが、このパターンの目的についての解説は比較的わかりやすいです。

> Strategy パターンは、アプリケーションで使用されるアルゴリズムを動的に切り替える必要がある際に有用である。Strategy パターンはアルゴリズムのセットを定義する方法を提供し、これらを交換可能にすることを目的としている。Strategy パターンにより、アルゴリズムを使用者から独立したまま様々に変化させることができるようになる。

実際に Strategy パターンがどういうものなのかを、サンプルコードを用いながら考えていきます。

## Strategy パターンを使用しない例

ゲームの敵をサンプルとして用います。

- [sample 1](https://github.com/hbsnow/design-pattern-php-sample/tree/master/htdocs/strategy/sample1)

Monser という具象クラスがあって、それぞれのモンスター

- Goblin (歩ける・攻撃できる)
- Slime (ゆっくり歩ける・攻撃できる)
- Mandragora (攻撃できる)
- Dragon (歩ける・飛べる・攻撃できる)

は Monser クラスを継承しています。共通でないモンスターの行動「歩く」と「飛ぶ」についてはインターフェースを作成してそれぞれの継承先のクラスに実装しました。

問題はインターフェースが実装をもたないことから、Goblin と Dragon の「歩く」という同じコードの再利用ができず、また変更に対して閉じていないために保守性が損なわれている点です。

## Strategy パターンを使用する例

- [sample 2](https://github.com/hbsnow/design-pattern-php-sample/tree/master/htdocs/strategy/sample2)

上記のサンプルでは「歩く」と「飛ぶ」の 2 つの振る舞いに対してプログラミングしています。PHP には Trait があるので Trait を使ってもいいかもしれませんが、ここでは使用していません。

攻撃することはすべてのモンスターに共通しているので、Monster 抽象クラスに攻撃するメソッドを記述しているのですが、この例であれば攻撃の種類は今後増えていきそうな気がするので、本来ここもインターフェースで切り出したほうがいいかもしれません。

## 開放/閉鎖原則

このパターンについては Open-Closed Principle(開放/閉鎖原則) を知っているとより理解しやすいと思う。開放/閉鎖原則も理解しにくいのですが、下記の動画はとてもわかりやすいのでおすすめです。

- [「SOLID の原則ってどんなふうに使うの？オープン・クローズドの原則編 拡大版」　 後藤英宣](https://www.youtube.com/watch?v=cUV1nXPfjFY)
