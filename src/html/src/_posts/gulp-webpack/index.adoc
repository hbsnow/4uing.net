---
title: gulpでwebpackを使う
description: gulpでwebpackを使ってJavaScriptをビルドする方法の解説です。
date: 2014-11-19
updated: 2015-06-24
tags: JavaScript, gulp, webpack
---

http://gulpjs.com/[gulp]でlink:http://webpack.github.io/[webpack]を使って、Web開発で使用するモジュールを管理してみます。



[[install]]
== インストール

link:../gulp-browserify/[browserifyのとき]と流れは同じです。

まずはgulpとwebpackのインストールします。WebPackはコマンドを使うことがあればグローバルにインストールする必要があるけれども、今回はgulpを使うのでグローバルにインストールしていません。

`package.js`を作成してプロジェクトを追加、ついでにその他必要になるパッケージもインストールしておきます。

[source,ps1]
----
npm init
npm install gulp webpack-stream gulp-load-plugins --save
----

loaderを使えばJadeやBabel、CoffeeScriptの変換もできます。



[[gulpfile]]
== gulpfile.js

このサイトの作成時に使用している`gulpfile.js`の一部です。

[source,js]
----
'use strict';

var gulp = require('gulp');
var objectAssign = require('object-assign');
var webpack = require('webpack-stream');
var $ = require('gulp-load-plugins')();

var watch = false;

gulp.task('build:js', function() {
  var src = 'src/scripts/main.js';
  var dist = 'tmp/scripts/';
  var config = {
    output: {
      filename: '[name].js'
    },
    module: {
      loaders: [
        {
          test: /\.jade$/,
          loader: 'jade'
        }
      ]
    },
  };

  if(watch) {
    config = objectAssign(config, {
      watch: true,
      devtool: '#inline-source-map'
    });

    return gulp.src(src)
      .pipe(webpack(config))
      .pipe(gulp.dest(dist));
  } else {
    return gulp.src(src)
      .pipe(webpack(config))
      .pipe(gulp.dest(dist));
  }
});

gulp.task('watch:js', function(cb) {
  watch = true;

  runSequence('build:js', cb);
});
----

webpackは機能自体は多くてちょっととっつきにくさはあるけれど、そのぶん`gulpfile.js`はbrowserifyを使ったときよりもだいぶシンプルになります。監視用のタスクはとくにそうだとおもう。



[[browserify]]
== browserifyとの使い分け

webpackで便利だと感じるのはbrowserifyやwatchifyなどのvinylを扱った大量のコードでの表現をwebpackでは簡単な記述で実現できるところ。基本的に監視タスクが必要になる場合には何も考えずにwebpackを使っています。



[[bibliography]]
== 参照文献

[bibliography]
* http://qiita.com/derui@github/items/5233b4ef8fbde1e80d33[JavaScript - BrowserifyからWebpackへの移行時の注意点 - Qiita]
